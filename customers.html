<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Customers ‚Ä¢ ADCB (Filters OK, No Actions)</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --adcb-red: #e60000;
      --adcb-black: #000000;
      --adcb-white: #ffffff;
      --adcb-light-gray: #f5f5f5;
      --adcb-dark-gray: #4d4d4d;
      --adcb-border-gray: #dddddd;
      --adcb-success: #28a745;
      --adcb-warning: #ffc107;
      --adcb-danger: #dc3545;
      --adcb-info: #17a2b8;
    }
    * { box-sizing: border-box; }

    body {
      font-family: 'Poppins', sans-serif;
      background: var(--adcb-light-gray);
      color: var(--adcb-dark-gray);
      margin: 0;
      display: flex;
      min-height: 100vh;
    }
    .sidebar {
      width: 250px;
      background: var(--adcb-white);
      height: 100vh;
      border-right: 1px solid var(--adcb-border-gray);
      padding-top: 24px;
      flex-shrink: 0;
      box-shadow: 2px 0 5px rgba(0,0,0,0.05);
      position: sticky;
      top: 0;
    }
    .sidebar .logo {
      padding: 0 24px 24px;
      border-bottom: 1px solid var(--adcb-border-gray);
      margin-bottom: 24px;
    }
    .sidebar .logo img { height: 24px; }
    .sidebar nav a {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 24px;
      color: var(--adcb-dark-gray);
      text-decoration: none;
      font-weight: 500;
      transition: background 0.2s ease, color 0.2s ease;
    }
    .sidebar nav a:hover { background: #f0f0f0; color: var(--adcb-red); }
    .sidebar nav a.active {
      background: var(--adcb-light-gray);
      font-weight: 700;
      border-left: 4px solid var(--adcb-red);
      padding-left: 20px;
      color: var(--adcb-red);
    }
    .main-content {
      flex-grow: 1;
      padding: 32px;
      display: flex;
      flex-direction: column;
      gap: 24px;
    }
    .page-header { display: flex; align-items: center; justify-content: space-between; }
    .page-header h1 { margin: 0; font-size: 28px; font-weight: 600; color: var(--adcb-black); }
    .btn {
      background: var(--adcb-red);
      color: var(--adcb-white);
      padding: 8px 12px;
      border: 0;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      font-size: 13px;
      transition: background-color 0.2s ease, transform 0.1s ease;
      white-space: nowrap;
    }
    .btn:hover { background-color: #c01e16; }
    .btn:active { transform: translateY(1px); }
    .btn.secondary { background: #e9ecef; color: var(--adcb-dark-gray); }

    .filters {
      background: var(--adcb-white);
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      padding: 16px;
      display: grid;
      gap: 16px;
    }
    .row { display: flex; gap: 12px; flex-wrap: wrap; }
    .row input, .row select {
      height: 40px;
      padding: 0 12px;
      border-radius: 4px;
      border: 1px solid var(--adcb-border-gray);
      font-size: 14px;
      flex: 1;
      min-width: 180px;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    .row input:focus, .row select:focus {
      outline: none;
      border-color: var(--adcb-red);
      box-shadow: 0 0 0 2px rgba(230, 0, 0, 0.2);
    }

    .table-card { background: var(--adcb-white); border-radius: 8px; overflow: hidden; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
    table { width: 100%; border-collapse: collapse; }
    th {
      background: #fafafa;
      color: var(--adcb-dark-gray);
      font-weight: 600;
      /* text-transform: uppercase;  // avoid Turkish 'ƒ∞' */
      letter-spacing: 0.2px;
      padding: 12px;
      font-size: 13px;
      text-align: left;
    }
    td { padding: 12px 16px; border-top: 1px solid var(--adcb-border-gray); font-size: 14px; text-align: left; vertical-align: middle; }
    tr:nth-child(even) { background: #fafafa; }
    a.link { color: var(--adcb-info); text-decoration: none; font-weight: 500; transition: color 0.2s ease; }
    a.link:hover { color: var(--adcb-red); text-decoration: underline; }

    .badge { display: inline-block; padding: 4px 10px; border-radius: 4px; font-size: 12px; font-weight: 600; }
    .badge.good { background-color: #d1fae5; color: #065f46; }
    .badge.warn { background-color: #fef3c7; color: #92400e; }
    .badge.bad  { background-color: #fee2e2; color: #991b1b; }

    .table-footer { display: flex; align-items: center; justify-content: space-between; padding: 12px 16px; border-top: 1px solid var(--adcb-border-gray); background: #fff; font-size: 14px; }
    .pager { display: flex; gap: 8px; }
    .pager button { padding: 6px 10px; border-radius: 4px; border: 1px solid var(--adcb-border-gray); background: #fff; cursor: pointer; font-size: 14px; transition: background-color 0.2s ease; }
    .pager button:hover { background-color: #f0f0f0; }

    .pill { padding: 2px 8px; border-radius: 999px; background: #f0f0f0; font-size: 12px; }
    .loading { padding: 16px; }
  </style>
</head>
<body>
  <aside class="sidebar">
    <div class="logo">
      <img src="logo.svg" alt="ADCB Logo">
    </div>
    <nav>
      <a href="dashboard.html" class="nav-link"><span>üìä</span> Dashboard</a>
      <a href="applications.html" class="nav-link"><span>üóÇ</span> Applications</a>
      <a href="customers.html" class="nav-link active"><span>üë•</span> Customers</a>
      <a href="tasks.html" class="nav-link"><span>‚úÖ</span> Tasks</a>
      <a href="reports.html" class="nav-link"><span>üìà</span> Reports</a>
      <a href="settings.html" class="nav-link"><span>‚öôÔ∏è</span> Settings</a>
      <a href="logout.html" class="nav-link"><span>üö™</span> Logout</a>
    </nav>
  </aside>

  <main class="main-content">
    <div class="page-header">
      <h1>Customers <span id="total" class="pill"></span></h1>
      <div style="display:flex; gap:8px">
        <button id="exportCsv" class="btn secondary">Export CSV</button>
        <button id="refresh" class="btn">Refresh</button>
      </div>
    </div>

    <section class="filters">
      <div class="row">
        <input id="searchInput" type="text" placeholder="Search by Name, Email or Customer ID" />
        <select id="statusSelect">
          <option value="">Status: All</option>
          <option>Active</option>
          <option>Blocked</option>
          <option>Pending KYC</option>
        </select>
        <select id="nationalitySelect">
          <option value="">Nationality: All</option>
          <option>UAE</option>
          <option>India</option>
          <option>Pakistan</option>
          <option>Jordan</option>
          <option>Lebanon</option>
          <option>Bangladesh</option>
          <option>Egypt</option>
          <option>Oman</option>
        </select>
        <select id="aecbSelect">
          <option value="">AECB: All</option>
          <option value="600">600+</option>
          <option value="650">650+</option>
          <option value="700">700+</option>
        </select>
        <button id="searchBtn" class="btn">Search</button>
      </div>
    </section>

    <section class="table-card">
      <table>
        <thead>
          <tr>
            <th>Customer ID</th>
            <th>Name</th>
            <th>Nationality</th>
            <th>AECB</th>
            <th>Status</th>
            <th>Application Date</th>
            <th>Last Update</th>
          </tr>
        </thead>
        <tbody id="tbody">
          <tr><td colspan="7" class="loading">Loading...</td></tr>
        </tbody>
      </table>
      <div class="table-footer">
        <div id="rangeLabel">Showing 0‚Äì0 of 0</div>
        <div class="pager">
          <button id="prevBtn">Prev</button>
          <button id="nextBtn">Next</button>
        </div>
      </div>
    </section>
  </main>

  <script>
    // ---- MOCK API LAYER ----
    const CUSTOMERS = [
      { customerId: "CUS-90012", name: "Layla Hassan",   nationality: "Egypt",      aecb: null, status: "Pending KYC", appDate: "2025-08-08", lastUpdate: "2025-08-10" },
      { customerId: "CUS-90013", name: "Omar Al Farsi",  nationality: "Oman",       aecb: 710,  status: "Active",      appDate: "2025-08-09", lastUpdate: "2025-08-11" },
      { customerId: "CUS-90014", name: "Fatima Noor",    nationality: "Pakistan",   aecb: null, status: "Blocked",     appDate: "2025-08-07", lastUpdate: "2025-08-09" },
      { customerId: "CUS-90015", name: "Mohammed Khan",  nationality: "Bangladesh", aecb: 600,  status: "Active",      appDate: "2025-08-10", lastUpdate: "2025-08-11" },
      { customerId: "CUS-90016", name: "Ali Jaber",      nationality: "Lebanon",    aecb: 750,  status: "Active",      appDate: "2025-08-10", lastUpdate: "2025-08-10" },
      { customerId: "CUS-90017", name: "Sara Mansoor",   nationality: "UAE",        aecb: 705,  status: "Active",      appDate: "2025-08-06", lastUpdate: "2025-08-12" },
      { customerId: "CUS-90018", name: "Ravi Patel",     nationality: "India",      aecb: 640,  status: "Pending KYC", appDate: "2025-08-09", lastUpdate: "2025-08-11" },
      { customerId: "CUS-90019", name: "Ahmad Youssef",  nationality: "Jordan",     aecb: 640,  status: "Blocked",     appDate: "2025-08-03", lastUpdate: "2025-08-10" },
      { customerId: "CUS-90020", name: "Zara Qureshi",   nationality: "Pakistan",   aecb: 680,  status: "Active",      appDate: "2025-08-10", lastUpdate: "2025-08-12" },
      { customerId: "CUS-90021", name: "Hassan Ali",     nationality: "Egypt",      aecb: 690,  status: "Active",      appDate: "2025-08-10", lastUpdate: "2025-08-12" },
      { customerId: "CUS-90022", name: "Meera Thomas",   nationality: "India",      aecb: 720,  status: "Blocked",     appDate: "2025-08-07", lastUpdate: "2025-08-09" },
      { customerId: "CUS-90023", name: "Yusuf Karim",    nationality: "Bangladesh", aecb: 650,  status: "Active",      appDate: "2025-08-09", lastUpdate: "2025-08-11" },
      { customerId: "CUS-90024", name: "Nadia Rahman",   nationality: "Pakistan",   aecb: 610,  status: "Pending KYC", appDate: "2025-08-09", lastUpdate: "2025-08-10" },
      { customerId: "CUS-90025", name: "Salim Omar",     nationality: "UAE",        aecb: 730,  status: "Active",      appDate: "2025-08-10", lastUpdate: "2025-08-12" }
    ];

    const api = {
      listCustomers: async ({ status = "", nationality = "", aecbMin = "", search = "", page = 1, pageSize = 10 } = {}) => {
        const delay = (ms) => new Promise(res => setTimeout(res, ms));
        await delay(250 + Math.random() * 300);

        const s = (search || "").trim().toLowerCase();
        let filtered = CUSTOMERS.filter(r =>
          (!status || r.status === status) &&
          (!nationality || r.nationality === nationality) &&
          (!aecbMin || (r.aecb ?? 0) >= +aecbMin) &&
          (!s || [r.customerId, r.name].join(" ").toLowerCase().includes(s))
        );

        const total = filtered.length;
        const start = (page - 1) * pageSize;
        const end = start + pageSize;
        const items = filtered.slice(start, end);

        return { items, total, page, pageSize };
      }
    };

    // ---- UI LAYER ----
    const tbody = document.getElementById("tbody");
    const statusSelect = document.getElementById("statusSelect");
    const nationalitySelect = document.getElementById("nationalitySelect");
    const aecbSelect = document.getElementById("aecbSelect");
    const pageSizeSel = document.getElementById("pageSize");
    const searchInput = document.getElementById("searchInput");
    const searchBtn = document.getElementById("searchBtn");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const rangeLabel = document.getElementById("rangeLabel");
    const totalPill = document.getElementById("total");
    const refreshBtn = document.getElementById("refresh");
    const exportBtn = document.getElementById("exportCsv");

    const badgeClass = (status) => {
      const good = ["Active"];
      const warn = ["Pending KYC"];
      const bad  = ["Blocked"];
      if (good.includes(status)) return "badge good";
      if (warn.includes(status)) return "badge warn";
      return "badge bad";
    };

    let state = { page: 1, pageSize: 10, status: "", nationality: "", aecbMin: "", search: "" };

    async function load() {
      tbody.innerHTML = `<tr><td colspan="7" class="loading">Loading...</td></tr>`;
      const { items, total, page, pageSize } = await api.listCustomers(state);
      totalPill.textContent = `${total} records`;
      rangeLabel.textContent = total === 0
        ? "Showing 0‚Äì0 of 0"
        : `Showing ${((page-1)*pageSize)+1}‚Äì${Math.min(page*pageSize,total)} of ${total}`;

      tbody.innerHTML = items.length ? items.map(r => `
        <tr>
          <td><a class="link" href="detail.html">${r.customerId}</a></td>
          <td><a class="link" href="detail.html">${r.name}</a></td>
          <td>${r.nationality}</td>
          <td>${r.aecb ?? "‚Äî"}</td>
          <td><span class="${badgeClass(r.status)}">${r.status}</span></td>
          <td>${r.appDate}</td>
          <td>${r.lastUpdate}</td>
        </tr>
      `).join("") : `<tr><td colspan="7" class="loading">No results</td></tr>`;
    }

    function readControls() {
      state.status = statusSelect.value || "";
      state.nationality = nationalitySelect.value || "";
      state.aecbMin = aecbSelect.value || "";
      state.search = searchInput.value || "";
    }

    searchBtn.addEventListener("click", () => { state.page = 1; readControls(); load(); });
    refreshBtn.addEventListener("click", () => load());
    prevBtn.addEventListener("click", () => { if (state.page > 1) { state.page--; load(); }});
    nextBtn.addEventListener("click", async () => {
      const next = await api.listCustomers({ ...state, page: state.page + 1 });
      if (next.items.length) { state.page++; load(); }
    });
    statusSelect.addEventListener("change", () => { state.page = 1; readControls(); load(); });
    nationalitySelect.addEventListener("change", () => { state.page = 1; readControls(); load(); });
    aecbSelect.addEventListener("change", () => { state.page = 1; readControls(); load(); });
    searchInput.addEventListener("keydown", (e) => { if (e.key === "Enter") { state.page = 1; readControls(); load(); } });

    exportBtn.addEventListener("click", async () => {
      const { items } = await api.listCustomers({ ...state, page: 1, pageSize: 10000 });
      const headers = ["Customer ID","Name","Nationality","AECB","Status","Application Date","Last Update"];
      const rows = items.map(r => [r.customerId, r.name, r.nationality, r.aecb ?? "", r.status, r.appDate, r.lastUpdate]);
      const csv = [headers, ...rows].map(r => r.map(x => `"${String(x).replace(/"/g,'""')}"`).join(",")).join("\n");
      const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "customers_export.csv";
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    });

    // initial load
    load();
  </script>
</body>
</html>
